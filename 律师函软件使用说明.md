# 律师函自动生成软件使用说明

## 一、软件简介

律师函自动生成软件是一款专为法律从业者设计的工具，可以根据预设模板和数据批量生成律师函文档，提高工作效率，减少重复劳动。本软件支持Word模板变量替换、Excel数据导入、批量文档生成等功能。

## 二、系统要求

- Python 3.8或更高版本
- 已安装的依赖库：python-docx、pandas、tkinter

## 三、快速入门

### 1. 准备模板文件

在Word文档中创建律师函模板，使用`{{变量名}}`格式作为占位符。例如：

```
尊敬的{{收件人}}：

关于：催收{{欠款人}}拖欠款项的律师函

本律师事务所受{{委托人}}的委托，就{{欠款人}}拖欠我委托人款项一事，特致函如下：
...
```

### 2. 准备数据文件

创建Excel文件，表头应与模板中的变量名对应。例如：

| 收件人 | 欠款人 | 委托人 | 欠款金额 | 逾期天数 | ... |
|--------|--------|--------|----------|----------|-----|
| 张三公司 | 张三 | 北京科技有限公司 | 50000 | 45 | ... |
| 李四企业 | 李四 | 上海贸易有限公司 | 120000 | 30 | ... |

### 3. 使用软件生成律师函

1. 启动软件：运行`python3 律师函测试.py`
2. 在"模板管理"标签页选择Word模板文件并解析变量
3. 在"数据导入"标签页选择Excel数据文件并加载数据
4. 使用"自动映射"功能将Excel列名与模板变量匹配
5. 在"文档生成"标签页设置输出目录和文件前缀
6. 点击"生成律师函"按钮开始批量生成文档

## 四、功能详解

### 1. 模板管理

- **选择模板**：点击"浏览..."按钮选择Word格式(.docx)的律师函模板
- **解析变量**：点击"解析变量"按钮，软件会自动识别模板中的所有`{{变量名}}`格式的占位符
- **变量列表**：解析后的变量会显示在列表中，方便查看和确认

### 2. 数据导入

- **选择数据文件**：点击"浏览..."按钮选择Excel格式(.xlsx/.xls)的数据文件
- **加载数据**：点击"加载数据"按钮，软件会读取Excel文件内容
- **自动映射**：点击"自动映射"按钮，软件会尝试将Excel表头与模板变量自动匹配
- **修改映射**：选中需要修改的映射项，点击"修改映射"按钮进行手动调整

### 3. 文档生成

- **输出目录**：选择生成的律师函文档保存位置
- **文件名前缀**：设置生成文件的命名前缀，最终文件名格式为：`YYYYMMDD_前缀_序号.docx`
- **输出格式**：选择生成文档的格式（Word或PDF）
- **生成进度**：显示文档生成的实时进度和状态

### 4. 设置

- **默认保存路径**：设置文档默认保存位置
- **保存设置**：保存当前配置，下次启动时自动加载

## 五、示例文件

软件包中提供了以下示例文件，方便用户快速上手：

1. **律师函模板.docx**：包含常见律师函结构和变量占位符的Word模板
2. **律师函数据示例.xlsx**：与模板变量对应的示例数据文件

## 六、常见问题

1. **问题**：模板变量无法正确解析
   **解决方案**：确保变量格式为`{{变量名}}`，大小写和空格需要完全匹配

2. **问题**：自动映射不准确
   **解决方案**：使用"修改映射"功能手动调整变量与Excel列的对应关系

3. **问题**：生成的文档变量未被替换
   **解决方案**：检查变量映射是否正确，Excel中是否有对应的数据

## 七、联系与支持

如有使用问题或建议，请联系开发团队：

- 邮箱：support@legaltools.com
- 电话：400-123-4567

---

© 2025 律师函自动生成软件 版权所有